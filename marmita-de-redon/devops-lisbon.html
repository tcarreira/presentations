<!DOCTYPE html>
<html>
  <head>
    <title>Podcast for free</title>
    <meta charset="utf-8" />
    <style>
      @import url(style.css);
    </style>
  </head>
  <body>
    <textarea id="source">


name: inverse
layout: true
class: center, middle, inverse

---

name: impact
layout: true
class: center, middle, impact, content

---

name: title
layout: true
class: title center

---

name: content
layout: true

---

template: title
name: main-title


.content[

<br><br><br><br><br><br><br><br><br><br><br><br>
### Build and host your podcast for free

.small[
How to leverage open source tools so everyone can host and automate a podcast
]

]

---

# About me
## Tiago Carreira

.left-column[


- Lisbon ðŸ‡µðŸ‡¹ &rarr; Rio de Janeiro ðŸ‡§ðŸ‡·
- DevOps Engineer<br>
- Hobbies:
.small[
- Sports (running, cycling, rock climbing)
- Music (clarinet, piano, guitar)
- Audiovisuals (photography, video, **podcasting**)
- Open Source
<br><br><br><br>
]
]

.rigth-column[
.center.pic-circle[
<img src="img/tcarreira.jpg" width="180">
]

.center.no-bullets.tiny[
**website:** tiago.carreira.pw<br>
**telegram:** @tcarreira<br>
**github:** github.com/tcarreira<br>
**twitter:** @tiagogcarreira
]

]

---

layout: false
name: agenda

# Build and host your podcast for free

.small[
How to leverage open source tools so everyone can host and automate a podcast
]
<br><br><br>
- Why
- Recording
- Editing
- Website
- Publishing
- Automation

---

# Options, too many options...


.center.comparison.small[

|                   | Hire a professional | Platform for<br>podcasters  |      Media hosting <br>(eg: soundcloud)        |                   Self-Hosted                   |                            Marmita de Redon                               |
|-------------------|:------------------------------:|:----------------------------------:|:--------------------------------------------------------:|:-----------------------------------------------:|:-------------------------------------------------------------------------:|
| Recording hardware |               âœ“âœ“               |                 ?                  |                            ?                             |                        ?                        |                                     ?                                     |
| Brand/Theme        |               âœ“âœ“               |               âœ“&#33;               |                            âœ“                             |                        âœ“                        |                                     âœ“                                     |
| Audio edition      |               âœ“âœ“               |               âœ“&#33;               |                            âœ“                             |                        âœ“                        |                                     âœ“                                     |
| Website           |               âœ“âœ“               |               âœ“&#33;               |                          âœ“&#33;                          |                        âœ“                        |                                     âœ“                                     |
| Hosting        |               âœ“âœ“               |                 âœ“âœ“                 |                            âœ“!                            |                        âœ“                        |                                     âœ“                                     |
| Analytics         |               âœ“âœ“               |                 âœ“âœ“                 |                            âœ“âœ“                            |                       âœ“âœ“                        |                                     âœ“                                     |
| Monetization       |               âœ“âœ“               |               âœ“/âœ“âœ“                 |                            âœ“                             |                        âœ“                        |                                     ?                                     |
| Full control    |               âœ“âœ“               |                 âœ—                  |                            âœ—                             |                        âœ“                        |                                     âœ“                                     |
|                   |                                |                                    |                                                          |                                                 |                                                                           |
| Cost            |             $$$$$              |                0-$$                |                           0-$                            |                       $$                        |                                     0                                     |
| Investid time   |               ðŸ•’               |                 ðŸ•’                  |                            ðŸ•’                            |                      ðŸ•’ðŸ•’                        |                                  ðŸ•’ðŸ•’ðŸ•’                                   |
| Maintenance ($/t)  |           $$$$ / ðŸ•’            |             0-$$ / ðŸ•’               |                         $$ / ðŸ•’                          |                    $$ / ðŸ•’                      |                                  0 / ðŸ•’                                   |


]

???


âœ“âœ“ - Feito pelo serviÃ§o  
âœ“&#33; - IncluÃ­do no serviÃ§o, mas nÃ£o Ã© ideal  
âœ“ - DisponÃ­vel (feito manualmente)  
âœ— - IndisponÃ­vel  
\* os custos nÃ£o incluem o material de gravaÃ§Ã£o, por ser comum a todos os serviÃ§os.

[1] Paid Podcasters Platforms: Acast, Blubrry, Buzzprout, Captivate, Castos, Descript, Podbean, Simplecast, Speaker, Transistor, etc...  
[2] Free Podcasters Platforms: <b>Anchor</b>, Breaker, Castbox, etc...



---

# Recording

.left-column[
## Using Smartphone

\+ Best possible cost (zero)<br>
&nbsp;&nbsp;&nbsp;&nbsp; if you have already a smartphone

\+ Accessible

\+ "enough" for recorging a podcast

\- Not enough professional quality
]
.right-column.center[
<img width="70%" src="img/me_recording.jpeg">
]


---

name: ediÃ§Ã£o

# Editing

.left-column[
- Import
- Syncronize
- Cut & paste
    - pre-filters
    - silencing noises
    - remove overlapping chat
    - make it natural
- Mastering
    - equalization
    - filters
    - compression
    - 8D modeling*
- Redering
]

.right-column.center[
<img height="80px" src="img/Audacity_Logo_signika_512_inverted_transparent.png">
]

--

.right-column[

<br><br>
### *8D modeling

- Spacial displacement for hosts <br> (Each host on a different "place")
- Sounds the same when listening a single channel
- Automated with an [audacity macro](https://github.com/marmita-de-redon/audacity-macros)
]


---

template: impact
name: website

# Website

---

# We need a website

.left-column[
- What we need
  - simple
  - able to list episodes
  - mobile
  - <b>RSS feeds for podcasts</b>
]

---

# Static HTML / Headless CMS - Hugo

.left-column[
- What we need
  - simple
  - able to list episodes
  - mobile
  - <b>RSS feeds for podcasts</b>
- Hugo
  - builds static HTML
  - theme: [hugo-redon-podcast](https://github.com/marmita-de-redon/hugo-redon-podcast) <br>
      - fork from [hugo clarity](github.com/chipzoller/hugo-clarity)
      - based on [VMware Clarity design](https://clarity.design/)
- Hosted on Github Pages
]

.right-column.center[
<br><br><br><br><br><br>
<img height="80px" src="img/hugo-logo-wide.svg">

<div>
  <img style="vertical-align:middle; margin-right:15px" height="80px" src="img/clarity-logo.svg">
  Clarity Design System
</div>
]

---

# Layout

.center[
<img height="400px" style="border: 2px solid #2db4fd;" src="img/website-desktop.png">
<img height="400px" style="border: 2px solid #2db4fd;" src="img/website-mobile.png">
]

---

# Hugo

.left-column.tiny[
```
.
â”œâ”€â”€ config
â”‚   â””â”€â”€ _default
â”‚       â””â”€â”€ menus
â”‚           â””â”€â”€ menu.pt.toml
â”œâ”€â”€ config.toml
â”œâ”€â”€ content
â”‚   â”œâ”€â”€ _index.md
â”‚   â”œâ”€â”€ contactos.md
â”‚   â”œâ”€â”€ feed
â”‚   â”‚   â””â”€â”€ podcast
â”‚   â”‚       â””â”€â”€ _index.md
â”‚   â”œâ”€â”€ post
â”‚   â”‚   â”œâ”€â”€ _index.md
â”‚   â”‚   â”œâ”€â”€ s01e00.md
â”‚   â”‚   â”œâ”€â”€ s01e01.md
â”‚   â”‚   â”œâ”€â”€ s01e02.md
â”‚   â”‚   â”œâ”€â”€ s01e03.md
â”‚   â”‚   â”œâ”€â”€ s01e04.md
â”‚   â”‚   â”œâ”€â”€ s01e05.md
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ sobre.md
â”‚   â””â”€â”€ subscrever.md
â”œâ”€â”€ data
â”‚   â””â”€â”€ social.yaml
â””â”€â”€ ...
```
]
.right-column.tiny[
```yaml
+++
title = "#16 Brinquedos (parte 1)"
itunes_title = "Brinquedos (parte 1)"
episode = 16
podcast_file = "https://media.blubrry.com/marmitaderedon/archive.org/download/marmitaderedon-s01e16/s01e16-brinquedos_1.mp3"
podcast_duration = "0:19:30"
podcast_bytes = "28091404"
author = "Marmita de Redon"
date = "2021-01-01"
description = "Pega-monstros, berlindes, tazos, tragabolas... Qual era o vosso brinquedo de eleiÃ§Ã£o? "
thumbnail = "images/s01e16.jpg"

featured = false
aliases = ["s01e16", "S01E16", "16"]
+++

Na altura em que a internet ainda era uma miragem,
esta malta brincava com coisas analÃ³gicas, feitas de um plÃ¡stico duvidoso dos anos 90.
Yo-yoâ€™s ou diÃ¡bolos entretinham-nos por horas e os pega-monstros eram o terror das raparigas no recreio.

## AtribuiÃ§Ã£o e licenÃ§as
- **Produzido por:** Joana Sanches, Marco Seabra, Tiago Carreira e Tiago MaurÃ­cio.
- **Editado por:** Tiago Carreira.
- **MÃºsica**: [Redon dos 90](https://archive.org/details/redon90) de Tiago Carreira, estÃ¡ licenciada nos termos da [LicenÃ§a Creative Commons - AtribuiÃ§Ã£o 4.0 Internacional](http://creativecommons.org/licenses/by/4.0/).

Este episÃ³dio estÃ¡ licenciado nos termos da [LicenÃ§a Creative Commons - AtribuiÃ§Ã£o-SemDerivaÃ§Ãµes 4.0 Internacional](https://creativecommons.org/licenses/by-nd/4.0/) (CC BY-ND 4.0).
```
]

---

# Website Hosting - Github Pages

.left-column[
- supports static HTML
- easy (more or less)
- bring your own domain
- HTTPS included (even for your own domain)
- nom mantainance
- free

<br><br>

### Hosting media files (audio episodes)
.center[
<img src="img/internet-archive.svg" height="60px">
]

]

.right-column[
<img height="400px" src="img/gh-pages.png" >
]

---

template: impact
name: publicacao

# Publishing

---

# Publication workflow

.left-column[
- record
- edit
- create text content (episode notes)
- create thumbnail
- upload to Archive.org
- create and render a new video (for youtube)
- create the new episode (markdown)
- publish new episode
]

---

# Publication workflow

.center[
<img height="450px" src="img/pub_workflow.drawio.svg">
]

---

# Publication workflow - Automation

.left-column[
- record
- edit
- create text content (episode notes)
- .not[create thumbnail]
- .not[upload to Archive.org]
- .not[create and render a new video (for youtube)]
- .not[create the new episode (markdown)]
- .not[publish new episode]
]
.right-column[
- record
- edit
- create text content (episode notes)
- **call a script** - it will run everything *

.tiny.right[
<br><br><br><br><br><br><br><br><br><br>
\* social networks not included
]
]


---

template: impact
name: automatizacao

# Automation

---

# Shell script - of course, why not...

```bash
function .main() {
  .check_pre_requisites
  .print_and_check_info

  .generate_thumbnail
  .upload_audio_to_archive_org
  .render_video
  .upload_to_youtube
  .create_markdown_file
  .commit_and_push_website
}
```


---

# Automation - create new thumbnail

`.generate_thumbnail`

.small[
```
python create_thumbnail.py "../images/base_thumbnail.png" "${THUMBNAIL_PATH}" "#1 TÃ­tulo do EpisÃ³dio"
```
<br>
`create_thumbnail.py`
```python
img = Image.open(image_source)
img_rgb = img.convert('RGB')
draw = ImageDraw.Draw(img_rgb)

font = ImageFont.truetype("font.ttf", 300)
w, h = draw.textsize(text, font=font)
position = (center_x-w/2, center_y-h/2)

draw.text(position, text, align="center", fill=color, font=font)
img_rgb = img_rgb.resize((1024,1024), resample=Image.BICUBIC)
img_rgb.save(image_dest)
```
]

<img
  style="
    position: absolute;
    bottom: 140px;
    right: 100px;
    z-index: 200;
    border: 2px solid #2db4fd;"
  height="200px"
  src="img/s01e01.jpg"
>



---

# Automation - upload audio file

`.upload_audio_to_archive_org`

.small[
```sh
./ia upload "${ARCHIVE_ORG_IDENTIFIER}" \
      "${AUDIO_PATH}" \
      "${THUMBNAIL_PATH}" \
      --metadata="mediatype:audio" \
      --metadata="language:por" \
      --retries 5
```
]

---

# Automation - render video

`.render_video`

.small[
```sh
ffmpeg \
  -loop 1 \
    -i "${THUMBNAIL_PATH}" \
    -i "${AUDIO_PATH}" \
  -shortest \
  -acodec copy \
  "${VIDEO_PATH}" -y
```
]
---

# Automation - upload to youtube

`.upload_to_youtube`

.small[
```sh
jq -n -f "${YOUTUBE_TEMPLATE_JSON_PATH}" \
      --arg title "${YOUTUBE_TITLE}" \
      --arg description "${BODY_MD_TEXT}$(echo -e "\n\n")${FOOTER_MD_TEXT}" \
      --arg privacystatus "${YOUTUBE_PRIVACY_STATUS}" \
      --arg license "${YOUTUBE_LICENCE}" \
  | shoogle execute -c "${GOOGLE_CREDENTIALS_PATH}" youtube:v3.videos.insert - -f "${VIDEO_PATH}"
```
]

.left-column.tiny[
```json
{
  "part": "snippet,status",
  "body": {
    "snippet": {
      "title": $title,
      "description": $description
    },
    "status": {
      "license": $license,
      "privacyStatus": $privacystatus,
      "selfDeclaredMadeForKids": false
    }
  }
}
```
]
.right-column.small[
notes:

Shoogle uses the youtube API which does not allow scheduled publishing.<br>
Other solutions exist:

https://github.com/ubuntupodcast/podpublish#youtube-api

]

---

# Automation - create new episode

`.create_markdown_file`

.small[
.left-column[

```sh
EPISODE_NUMBER=16                                                                                    # number, not string
TITLE="Brinquedos (parte 1)"                                                                         # title without episode number.
DESCRIPTION="Pega-monstros, berlindes, tazos, tragabolas... Qual era o vosso brinquedo de eleiÃ§Ã£o? " # Short description
AUDIO_PATH="../rendered/s01e16-brinquedos_1.mp3"                                                     # this file will be uploaded to archive.org
PUBLISHED_AT="2021-01-01"                                                                            # publish date. eg: 2020-01-31

BODY_MD_TEXT="
Na altura em que a internet ainda era uma miragem, 
esta malta brincava com coisas analÃ³gicas, feitas de um plÃ¡stico duvidoso dos anos 90. 
Yo-yoâ€™s ou diabolos entretinham-nos por horas e os pega-monstros eram o terror das raparigas no recreio.
"
```
```
echo "${MARKDOWN_TEMPLATE}" >"${_markdown_post_file}"
```

]
.right-column[
```sh
MARKDOWN_TEMPLATE="+++
title = \"#${EPISODE_NUMBER} ${TITLE}\"
itunes_title = \"${TITLE}\"
episode = ${EPISODE_NUMBER}
podcast_file = \"${AUDIO_URL}\"
podcast_duration = \"${AUDIO_DURATION}\"
podcast_bytes = \"${AUDIO_BYTES}\"
author = \"${AUTHOR}\"
date = \"${PUBLISHED_AT}\"
description = \"${DESCRIPTION}\"
thumbnail = \"${THUMBNAIL_URL}\"

featured = ${WEBSITE_FEATURED}
aliases = [\"${_SxxExx}\", \"${EPISODE_NUMBER}\"]
+++
${BODY_MD_TEXT}

${FOOTER_MD_TEXT}"
```
]
]
---

# Automation - publishing

`.commit_and_push_website`


.small[
```sh
git add "${POST_RELATIVE_PATH}"
git add "${POST_IMAGE_RELATIVE_PATH}"
git commit -m "Publishing s01e01.md + s01e01.jpg"
git push

```
]

---

# Automation

## Github Actions

.small[
```
jobs:
  deploy:
    runs-on: ubuntu-20.04
    steps:
      - uses: actions/checkout@v2
        with:
          submodules: true # Fetch Hugo themes (true OR recursive)
          fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod

      - name: Build
        run: |
          hugo --gc --minify --cleanDestinationDir

      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./public
```
]


---

# AutomatizaÃ§Ã£o

## Github Actions (auto-publish)

.small[
```
on:
  schedule:
    # Every Friday at 1:00 (AM) UTC
    - cron:  '0 1 * * 5'
  push:
    branches:
      - main

```
]

---

template: impact

# That's all folks
<img src="img/warner-bros-michigan-j-frog-logo.png" height="340px">

---

# Review later

## Slides

- https://tcarreira.github.io/presentations/marmita-de-redon/devops-lisbon.html
- https://github.com/tcarreira/presentations

## Other content

- https://marmita.pt
- https://github.com/marmita-de-redon
  - website: https://github.com/marmita-de-redon/website
  - theme: https://github.com/marmita-de-redon/hugo-redon-podcast
  - automatization: https://github.com/marmita-de-redon/automation

---

template: title

<br><br><br><br><br><br><br><br><br><br><br>

.content[.align-center[
## Thanks
]]

.center.small[
tiago.carreira.pw | github.com/tcarreira | telegram: @tcarreira
.tiny[
Podcast authors: Joana Sanches, Marco Seabra, Tiago Carreira, Tiago MaurÃ­cio
]
]




    </textarea>
    <!--
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    -->
    <script src="remark-latest.min.js"></script>
    <script>
      var slideshow = remark.create({
        slideNumberFormat: "%current%",
        ratio: "16:9",
        navigation: {
          scroll: false,
        },
        highlightStyle: "monokai",
        highlightLines: true,
        highlightSpans: true,
      });
    </script>
    <script src="jquery.min.js"></script>
    <script>
      Array.from($(".remark-code-line")).forEach((el) => {
        el.innerHTML = el.innerHTML
          .replace(
            "&lt;--&gt;",
            '<span class="remark-code-line-highlighted-removed-bg">'
          )
          .replace("&lt;/--&gt;", "</span>");
        el.innerHTML = el.innerHTML
          .replace(
            "&lt;red&gt;",
            '<span class="remark-code-line-highlighted-red">'
          )
          .replace("&lt;/red&gt;", "</span>");
        el.innerHTML = el.innerHTML
          .replace(
            "&lt;-&gt;",
            '<span class="remark-code-line-highlighted-removed">'
          )
          .replace("&lt;/-&gt;", "</span>");
        el.innerHTML = el.innerHTML
          .replace(
            "&lt;+&gt;",
            '<span class="remark-code-line-highlighted-added">'
          )
          .replace("&lt;/+&gt;", "</span>");
        el.innerHTML = el.innerHTML
          .replace(
            "&lt;+&gt;",
            '<span class="remark-code-line-highlighted-added">'
          )
          .replace("&lt;/+&gt;", "</span>");
        el.innerHTML = el.innerHTML
          .replace("&lt;=&gt;", '<span class="remark-code-line-highlighted">')
          .replace("&lt;/=&gt;", "</span>");
        el.innerHTML = el.innerHTML
          .replace("&lt;=&gt;", '<span class="remark-code-line-highlighted">')
          .replace("&lt;/=&gt;", "</span>");
      });

      // Css hack (remove top margin if column has h2 inside)
      $(".left-column:has(h2)").addClass("remove-top-space");
      $(".right-column:has(h2)").addClass("remove-top-space");
    </script>
  </body>
</html>
